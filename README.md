# malware-detector
A Random Forest Classifier that classifies a file as malicious or benign based on its PE Headers

Dataset: Top 1000 PE Imports compiled by Angelo Oliviera (Dataset DOI: 10.21227/004e-v304, source: https://ieee-dataport.org/open-access/malware-analysis-datasets-top-1000-pe-imports).
Consists of 1001 features comprising of the fields of the PE Header, along with an additional label ("malware") denoting whether the PE header was malicious or benign. All features were int (0 or 1) except for the unique character field "hash", which had to be excluded from analysis.

Feature Engineering: In order to improve the accuracy of the model, we had to remove any redundant features, such as to use the least number of features that would yield the best result. We ultimately used only 20 features, as described below:

1. OpenProcess 
2. LoadLibraryA
3. GetProcessHeap
4. ShellExecuteW
5. VirtualFree
6. GetDC
7. IsDebuggerPresent
8. malloc
9. FindNextFileA
10. free
11. GetAsyncKeyState
12. GetTickCount
13. exit
14. _cexit
15. VirtualAlloc
16. VirtualProtect
17. GetModuleHandleA
18. ExitProcess
19. RegCloseKey
20. GetCurrentProcessId

Classifier: We used a Random Forest Classifier. To avoid overfitting, we tuned the following hyperparameters with RandomizedSearchCV and GridSearchCV:

1. bootstrap: method for sampling data points (with or without replacement) ('False' value denotes thar entire dataset used to make trees)
2. max_depth: max number of levels in each decision tree (More depth may lead to single leaf nodes in each tree, less depth may not be sufficient enough to capture the info)
3. max_features: max number of features considered for splitting a node
4. n_estimators: number of trees in the forest
5. min_samples_split: min number of data points placed in a node before the node is split (how many samples are needed to split the node)
6. min_samples_leaf: min number of data points allowed in a leaf node (helps smoothen the model)

Model Evaluation: The model was evaluated on the following metrics:

1. Out of Bag Score
2. Accuracy (training, cross validation and test)
3. Confusion Matrix (cross validation and test)
4. Precision (cross validation and test)
5. Recall (cross validation and test)
6. F1 Score (cross validation and test)
